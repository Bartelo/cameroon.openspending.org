---
layout: default
title: Cameroon
section: home
---

<h2 class="page-header">Where does Cameroons Money Go?</h2>

<div class="row">
    <div class="span7">
        <div id="map"></div>
    </div>
    <div class="span5">
        <div id="sidebar">
            <h3>How does my region spend its funds?</h3>
            <p>
                Select a region to see budget and survey
                information related to it.
            </p>
        </div>
    </div>
</div>

<hr>

<ul>
    <li><h3><span class="label label-info">Survey</span>
        <a href="bti.html">How well do local councils mange their budgets?</a>
        <small>Amadawa Region</small>
    </h3></li>
    <li><h3>
        <span class="label label-info">Investments</span>
        <a href="nwregion.html">What does my region invest in?</a>
        <small>North-West Region</small>
    </h3></li>
    <li><h3>
        <span class="label label-info">Investments</span>
        <a href="pib.html">What does Cameroon invest in?</a>
        <small>Cameroon</small>
    </h3></li>
    <li><h3><span class="label label-info">Budget</span> How does my council spend its money?
        <small>Tignere, Amadawa</small>
    </h3></li>
</ul>

{% raw %}
<script id="region-sidebar" type="application/handlebars">
    <h3>National Level</h3>
    <ul class="budget-list">
        {{#national}}
        <li class="{{level}}"><a href="{{link}}">{{label}} <i class='icon-white icon-share-alt'></i></a></li>
        {{/national}}
    </ul>
    {{#if regional}}
    <h3>Region: <strong>{{regionLabel}}</strong></h3>
    <ul class="budget-list">
        {{#regional}}
        <li class="{{level}}"><a href="{{link}}">{{label}} <i class='icon-white icon-share-alt'></i></a></li>
        {{/regional}}
    </ul>
    {{/if}}
    {{#if council}}
    <h3>Local Councils</h3>
    <ul class="budget-list">
        {{#council}}
        <li class="{{level}}"><a href="{{link}}">{{label}} <i class='icon-white icon-share-alt'></i></a></li>
        {{/council}}
    </ul>
    {{/if}}
</script>
{% endraw %}

<script>
    $(function() {
        
        var sidebarTemplate = Handlebars.compile($('#region-sidebar').html());

        $.getJSON('/data/datasets.json', function(datasets) {
            window.map = $K.map('#map',500,450);//('#map',368,544);

            var showData = function(region) {
                var data = _.groupBy(
                        _.filter(datasets, function(ds) {
                            return !ds.region||ds.region==region;
                        }),
                        function(e) { return e.level; });
                data.regionLabel = region;
                console.log(data);
                $('#sidebar').html(sidebarTemplate(data));
            }

            var setPathCol = function(path, selected, border){
                path.realFill = path.svgPath.attrs.fill;
                path.svgPath.attr({'fill': selected ? '#cc0033' : '#007a5e'});
                return path;
            }

            var setRegionCol = function(region, col, border){
                var path = map.getLayerPath('region', region);
                return setPathCol(path, col, border);
            }

            var selectRegion= function(region){
                if(selectedRegion!=null){
                    var path = setRegionCol(selectedRegion, false, false);
                    path.svgPath.attr({'stroke-width': 1});
                }
                selectedRegion = region;
                var path = setRegionCol(selectedRegion, true, true);
                path.svgPath.attr({'stroke-width': 3});
            }

            // communes.svg adamawa.svg cameroon.svg north_west.svg regions.svg region_communes.svg
            map.loadMap('/img/regions.svg', function(map) {
                map.addLayer({
                    id: 'region',
                    key: 'region'
                });

                map.tooltips({
                    layer: 'region',
                    content: function(data) {
                        var count = _.filter(datasets, function(ds) {
                            return !ds.region||ds.region==data;
                        }).length;
                        return data + ' (' + count + ')';
                    },
                    style: {
                        name: 'dark'
                    }
                });

                map.onLayerEvent('click', function(d) {
                    selectRegion(d.region);
                    showData(d.region);
                });

                var layer = map.getLayer('region');
                for(var i=0;i<layer.paths.length;i++){
                    var path = layer.paths[i];
                    setPathCol(path, false, false);
                }

                map.onLayerEvent('mouseover', function(d) {
                    setRegionCol(d.region, true, false);
                });

                map.onLayerEvent('mouseout', function(d) {
                    if(d.region!=selectedRegion){
                        setRegionCol(d.region, false, false);
                    }
                });
            });
        });
    });

</script>